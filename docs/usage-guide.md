# Azure Personal Voice Playground - 使用ガイド

## 目次
1. [はじめに](#はじめに)
2. [事前準備](#事前準備)
3. [アプリケーションの起動](#アプリケーションの起動)
4. [Azure Speech Service への接続](#azure-speech-service-への接続)
5. [Personal Voice の作成](#personal-voice-の作成)
6. [音声合成のテスト](#音声合成のテスト)
7. [トラブルシューティング](#トラブルシューティング)

## はじめに

Azure Personal Voice Playground は、Azure Speech Service の Personal Voice 機能を簡単にテストできるウェブアプリケーションです。ブラウザ上で動作し、サーバーのセットアップは不要です。

### 主な機能
- ✅ Azure Speech Service への簡単接続
- ✅ Personal Voice の新規作成
- ✅ 既存の Personal Voice 一覧表示
- ✅ 任意のテキストを Personal Voice で音声合成
- ✅ 合成音声の再生とダウンロード

## 事前準備

### 1. Azure リソースの準備

Personal Voice を使用するには、Azure Speech Service のリソースが必要です。

#### Azure Portal での設定手順

1. [Azure Portal](https://portal.azure.com) にサインイン
2. 「リソースの作成」をクリック
3. 「Speech」を検索して選択
4. 以下の情報を入力:
   - **サブスクリプション**: お使いのサブスクリプション
   - **リソースグループ**: 新規作成または既存のものを選択
   - **リージョン**: 例: `East US`, `West Europe` など
   - **名前**: 一意のリソース名
   - **価格レベル**: F0（無料）または S0（標準）
5. 「確認および作成」→「作成」をクリック
6. デプロイ完了後、リソースに移動
7. 「キーとエンドポイント」から以下を確認:
   - **キー 1** または **キー 2**（サブスクリプションキー）
   - **場所/リージョン**（例: eastus）

### 2. 音声ファイルの準備

Personal Voice を作成するには、以下の音声ファイルが必要です:

#### 同意書音声ファイル
- **形式**: WAV
- **内容**: 話者本人による同意の音声
- **推奨**: 16kHz、16bit、モノラル
- **重要**: 以下のURLにあるサンプル文例から、自分の母国語の文章を選び、自分の名前と社名を組み込んだうえで読み上げてください
  - サンプル文例URL: https://github.com/Azure-Samples/Cognitive-Speech-TTS/blob/master/CustomVoice/script/verbal-statement-all-locales.txt

#### 学習用音声ファイル
- **形式**: WAV
- **内容**: 話者の特徴を捉えた音声サンプル
- **長さ**: **5秒以上90秒未満**（必須）
- **推奨**: 16kHz、16bit、モノラル

> **注意**: 音声ファイルは事前に準備しておいてください。アプリ内での録音機能は現在サポートされていません。

## アプリケーションの起動

### 方法 1: ローカルファイルから開く

1. リポジトリをクローンまたはダウンロード
   ```bash
   git clone https://github.com/tokawa-ms/Personal_Voice_Playground.git
   cd Personal_Voice_Playground
   ```

2. `src/index.html` をブラウザで開く
   - ファイルエクスプローラーからダブルクリック
   - または、ブラウザにファイルをドラッグ&ドロップ

### 方法 2: ローカルサーバーを使用（推奨）

CORS の問題を避けるため、ローカルサーバーの使用を推奨します。

```bash
# Python を使う場合
cd src
python -m http.server 8000

# Node.js (npx) を使う場合
cd src
npx http-server -p 8000
```

ブラウザで `http://localhost:8000` を開く

## Azure Speech Service への接続

### ステップ 1: 接続情報の入力

アプリケーションを開くと、画面上部に接続設定パネルが表示されます。

1. **サブスクリプションキー**: Azure Portal で取得したキーを入力
   - 例: `a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6`

2. **サービスリージョン**: リソースのリージョンを入力
   - 例: `eastus`, `westeurope`, `japaneast`
   - 小文字で入力してください

3. **接続ボタン**をクリック

### ステップ 2: 接続確認

- 接続に成功すると、「接続成功！」というメッセージが表示されます
- 接続パネルが自動的に折りたたまれ、メインコンテンツが表示されます
- 接続に失敗した場合は、キーとリージョンを確認してください

## Personal Voice の作成

Personal Voice を新規作成するには、左側パネルの「新規作成」タブを使用します。

### ステップ 1: プロジェクトの作成

1. **新規作成**タブをクリック
2. **プロジェクト名**を入力（例: "マイボイスプロジェクト"）
3. **プロジェクト説明**を入力（任意）
4. **プロジェクトを作成**ボタンをクリック
5. 作成成功すると、プロジェクト ID が表示されます

### ステップ 2: 同意書のアップロード

1. **同意書ファイル**の「ファイルを選択」をクリック
2. 準備した同意書音声ファイル（WAV）を選択
3. **同意書をアップロード**ボタンをクリック
4. アップロード成功すると、同意書 ID が表示されます

### ステップ 3: 学習用音声のアップロード

1. **音声ファイル**の「ファイルを選択」をクリック
2. 準備した学習用音声ファイル（WAV）を選択
3. **話者名**を入力（例: "太郎"）
4. **音声をアップロード**ボタンをクリック
5. アップロード成功すると、話者プロファイル ID が表示されます
6. 処理が完了するまで数秒〜数分待ちます
7. 「既存の Voice」タブで新しい Personal Voice を確認できます

## 音声合成のテスト

作成した Personal Voice を使って音声合成をテストします。

### ステップ 1: Personal Voice の選択

右側パネルで以下を設定します:

1. **Personal Voice を選択**: ドロップダウンから使用する Voice を選択
   - 左側パネルの「既存の Voice」リストから「選択」ボタンをクリックすることもできます

2. **言語を選択**: 合成する言語を選択
   - 日本語、英語、中国語など、8言語に対応

### ステップ 2: テキストの入力

**合成するテキスト**欄に、音声化したいテキストを入力します。

例:
```
こんにちは。Azure Personal Voice のテストです。
この音声は私の声をもとに合成されています。
```

### ステップ 3: 音声合成の実行

1. **音声合成を実行**ボタンをクリック
2. 処理が完了すると、音声プレイヤーが表示されます
3. 再生ボタンで音声を確認できます

### ステップ 4: 音声のダウンロード

合成された音声は MP3 形式でダウンロードできます:

1. **音声をダウンロード**ボタンをクリック
2. ファイルが `personal_voice_[タイムスタンプ].mp3` として保存されます

## トラブルシューティング

### 接続エラー

**症状**: 「接続失敗」と表示される

**原因と対処**:
- ❌ サブスクリプションキーが間違っている
  - ✅ Azure Portal で正しいキーを確認してコピー&ペースト
- ❌ サービスリージョンが間違っている
  - ✅ リージョン名を小文字で入力（例: `eastus`）
- ❌ ネットワーク接続の問題
  - ✅ インターネット接続を確認

### Personal Voice が表示されない

**症状**: 「既存の Voice」タブにリストが表示されない

**原因と対処**:
- ❌ まだ Personal Voice を作成していない
  - ✅ 「新規作成」タブから Personal Voice を作成
- ❌ 処理が完了していない
  - ✅ 数分待ってから「リストを更新」ボタンをクリック

### ファイルアップロードエラー

**症状**: 同意書や音声のアップロードが失敗する

**原因と対処**:
- ❌ ファイル形式が WAV ではない
  - ✅ WAV 形式に変換してから再度アップロード
- ❌ ファイルサイズが大きすぎる
  - ✅ ファイルサイズを縮小（推奨: 10MB 以下）
- ❌ プロジェクトが作成されていない
  - ✅ ステップ1から順番に実行

### 音声合成エラー

**症状**: 「音声合成に失敗しました」と表示される

**原因と対処**:
- ❌ Personal Voice が選択されていない
  - ✅ ドロップダウンから Voice を選択
- ❌ テキストが入力されていない
  - ✅ 合成するテキストを入力
- ❌ Personal Voice の処理が完了していない
  - ✅ 数分待ってから再度実行

### ブラウザのコンソールでエラーを確認

詳細なエラー情報は、ブラウザの開発者ツールで確認できます:

1. **Chrome / Edge**: F12 キーを押す
2. **Firefox**: F12 キーを押す
3. **Safari**: Command + Option + I (Mac)
4. 「Console」タブを開く
5. エラーメッセージを確認

## ヒントとベストプラクティス

### Personal Voice の品質向上

- 📌 クリアで雑音の少ない音声ファイルを使用
- 📌 話者の自然な話し方を録音
- 📌 十分な長さの音声サンプル（30秒以上推奨）

### 音声合成のコツ

- 📌 長文は適度に句読点を入れる
- 📌 読みが難しい単語は平仮名で入力
- 📌 数字や記号は音声化しやすい形式で入力

### セキュリティ

- 🔒 サブスクリプションキーは他人と共有しない
- 🔒 公開された場所にキーを掲載しない
- 🔒 使用後はブラウザを閉じて情報をクリア

## サポートとフィードバック

### 公式ドキュメント
- [Azure Speech Service ドキュメント](https://learn.microsoft.com/ja-jp/azure/ai-services/speech-service/)
- [Personal Voice 概要](https://learn.microsoft.com/ja-jp/azure/ai-services/speech-service/personal-voice-overview)

### GitHub リポジトリ
- [Issues](https://github.com/tokawa-ms/Personal_Voice_Playground/issues): バグ報告や機能リクエスト
- [Discussions](https://github.com/tokawa-ms/Personal_Voice_Playground/discussions): 質問や議論

## 次のステップ

Personal Voice Playground の基本的な使い方をマスターしたら:

1. 🎯 複数の Personal Voice を作成してテスト
2. 🎯 異なる言語での音声合成を試す
3. 🎯 長文の音声合成に挑戦
4. 🎯 生成した音声を実際のプロジェクトで活用

Happy Voice Synthesis! 🎤✨
